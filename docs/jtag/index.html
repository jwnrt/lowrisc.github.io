<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>lowRISC Refresh internals &middot; lowRISC</title>
        <link rel="stylesheet" href="https://www.lowrisc.org/css/styles.combined.min.css" />
        <link rel="shortcut icon" href="https://www.lowrisc.org/favicon.ico" />
        <link rel="alternate" href="https://www.lowrisc.org/index.xml" type="application/rss+xml" title="lowRISC" />
        <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' type='text/css'>
        <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Exo+2' type='text/css'>
        <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-53520714-1', 'auto');
        ga('send', 'pageview');
      </script>
  </head>

  <body data-page="article">
<div class="header">
  <header data-component="menu">

    <section class="outer-container">
      <div class="image">
        <a href="https://www.lowrisc.org"><img src="https://www.lowrisc.org/img/logo.svg"></a>
      </div>

      <div class="menu">
        <ul>
          
          <li><a href="/"> Home </a></li>
          
          <li><a href="/about/"> About </a></li>
          
          <li><a href="/blog/"> Blog </a></li>
          
          <li><a href="/faq/"> FAQ </a></li>
          
          <li><a href="/docs/"> Docs </a></li>
          
          <li><a href="/community/"> Community </a></li>
          
        </ul>
      </div>
    </section>

  </header>
</div>









    <div class="article">
      <section class="outer-container">
        <div class="row">
            <div class="sixteen columns">
                <article class="li-article">
                
                  <p>
                    <a href="https://www.lowrisc.org/docs/refresh-v0.6/">â‡¡ Tutorial for the v0.6 lowRISC release</a>
                  </p>
                
                    <header class="li-article-header">
                        <h1 class="li-article-title">lowRISC Refresh internals</h1>
                        <span class="li-article-taxonomies">
                            

                            
                        </span>
                        
                        
                    </header>
                    <section>
                        

<p>This lowRISC release introduces refresh debugging and compressed instructions, allowing upstream debian Linux distribution to be used.</p>

<h2 id="rtl-changes:0d68dae554c1f78133b40bb136574e92">RTL changes</h2>

<p>The JTAG uses Xilinx built-in instruction register of 6 bits and available user data registers.
These data register numbers deviate from the RISC-V specification but otherwise conforms to the Berkeley Rocket standard.
This deviation eliminates the requirement for separate hardware to implement the debug interface and keeps costs low,
allowing the same board (Nexys4DDR) as previously to be used.
The impact on the Chisel is restricted to a small part which invokes BSCANE2 as a primitive.</p>

<table>
<thead>
<tr>
<th>Function</th>
<th align="center"><em>Berkeley Rocket</em></th>
<th align="center"><em>LowRISC Rocket</em></th>
</tr>
</thead>

<tbody>
<tr>
<td>Manufacturer code</td>
<td align="center">all</td>
<td align="center">0x49</td>
</tr>

<tr>
<td>IR length</td>
<td align="center">5</td>
<td align="center">6</td>
</tr>

<tr>
<td>IDCODE</td>
<td align="center">0x01</td>
<td align="center">0x09</td>
</tr>

<tr>
<td>DTM_CONTROL</td>
<td align="center">0x10</td>
<td align="center">0x22</td>
</tr>

<tr>
<td>DTM_DMI</td>
<td align="center">0x11</td>
<td align="center">0x23</td>
</tr>
</tbody>
</table>

<p>This functionality needs to be supported with appropriate TCL which, in the case of Nexys4DDR will be:</p>

<pre><code>interface ftdi
ftdi_device_desc &quot;Digilent USB Device&quot;
ftdi_vid_pid 0x0403 0x6010

ftdi_channel 0
ftdi_layout_init 0x0088 0x008b
ftdi_tdo_sample_edge falling

reset_config none
adapter_khz 10000
transport select jtag

jtag newtap riscv cpu -irlen 6 -expected-id 0x13631093

target create riscv.cpu riscv -chain-position riscv.cpu
</code></pre>

<h2 id="linux-driver:0d68dae554c1f78133b40bb136574e92">Linux driver</h2>

<p>The JTAG does not impact on Linux operation. Extra facilities are available if KGDB is compiled in and it is not clear what the virtual memory approach will be in GDB at the moment.</p>

<h2 id="user-land-operation:0d68dae554c1f78133b40bb136574e92">User land operation</h2>

<p>A complete suite of Linux user commands is available via the Debian Linux distribution for RISCV. There is not necessity for the distribution to be built from scratch.</p>

<h2 id="remote-booting:0d68dae554c1f78133b40bb136574e92">Remote booting</h2>

<p>All the booting methods of the previous release are possible but for debugging most users will find it convenient to just load BBL with Linux appended inside GDB.</p>

                    </section>
                </article>

        </div>
      </section>
    </div>
    
    <div class="row li-pagination article">
      <div class="eight columns">
        <div class="li-pagination-previous">
          &nbsp;
          
        </div>
      </div>
      <div class="eight columns">
        <div class="li-pagination-next">
          &nbsp;
          
        </div>
      </div>
    </div>
    


                

            <div id="disqus_thread"></div>
            <script type="text/javascript">
                 
                var disqus_shortname = 'lowrisc'; 
                var disqus_identifier = "/" + "docs/jtag";
                var disqus_title = "lowRISC Refresh internals";
                var disqus_url = "https://www.lowrisc.org" + "docs/jtag";

                 
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
            

        <footer>

          <section class="outer-container">

            <div>
              <div class="link-container">
              </div>
            </div>

            <p>
              Unless otherwise noted, content on this site is licensed under a Creative Commons Attribution ShareAlike 4.0 International License
            </p>

          </section>

        </footer>
    </body>
</html>


    </body>
</html>

